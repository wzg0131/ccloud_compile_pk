(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"2ARg":function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("26FU"),r=i("CcnG"),o=function(){function e(){this.eventSource=new n.a(null),this.events$=this.eventSource.asObservable()}return e.prototype.emit=function(e){this.eventSource.next(e)},e.ngInjectableDef=r.Tb({factory:function(){return new e},token:e,providedIn:"root"}),e}()},"3aSq":function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i("xj3x");var n=function(){function e(e,t,i){var n=this;this.el=e,this.dragDropService=t,this.cdRef=i,this.element=this.el.nativeElement,this.dragDropService.showOuterHighLight.subscribe(function(e){0!==t.dragTargets.length&&(e?(n.cdRef.detach(),"start"===e.type&&n.addOuterElement(),e.rect&&n.scale&&n.scaleTo(e.rect.Width*e.scale,e.rect.Height*e.scale,e.rect.Y*e.scale,e.rect.X*e.scale)):(n.cdRef.reattach(),n.removeOuterElement()))})}return e.prototype.scaleTo=function(e,t,i,n){this.outerElement&&(this.outerElement.style.width=e+"px",this.outerElement.style.height=t+"px",this.outerElement.style.top=i+"px",this.outerElement.style.left=n+"px",this.outerElement.style.right=null,this.outerElement.style.bottom=null)},e.prototype.createOuterElement=function(){var e,t,i=document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.right="0",i.style.bottom="0",i.style.pointerEvents="none",i.style.textAlign="center",i.style.fontSize="24px",i.style.lineHeight="30px",i.style.transition="200ms",this.color?(i.style.border="4px dashed "+this.color,i.style.color=this.color):(i.style.border="4px dashed red",i.style.color="red"),this.text&&(i.innerText=this.text),this.styleSheet&&"object"==typeof this.styleSheet)try{for(var n=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],i=0;return t?t.call(e):{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}}}(Object.keys(this.styleSheet)),r=n.next();!r.done;r=n.next()){var o=r.value;i.style[o]=this.styleSheet[o]}}catch(l){e={error:l}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return i},e.prototype.addOuterElement=function(){this.outerElement&&this.outerElement.parentNode===this.element||(this.outerElement=this.createOuterElement(),this.element.appendChild(this.outerElement))},e.prototype.removeOuterElement=function(){this.outerElement&&this.outerElement.parentNode===this.element&&this.outerElement.parentNode.removeChild(this.outerElement)},e}()},JjIB:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("CcnG"),r=(i("xj3x"),i("bne5")),o=function(){function e(e,t,i,o){var l=this;this.elRef=e,this.dragDropService=t,this.ngZone=i,this.cdRef=o,this.dropEmitter=new n.n,this.element=e.nativeElement,this.ngZone.runOutsideAngular(function(){l.dragoverSub=Object(r.a)(l.element,"dragover").subscribe(function(e){l.onDragOver(e)}),l.dragenterSub=Object(r.a)(l.element,"dragenter").subscribe(function(e){l.onDragEnter(e)}),l.dragleaveSub=Object(r.a)(l.element,"dragleave").subscribe(function(e){l.onDragLeave(e)})})}return e.prototype.onDragOver=function(e){e.preventDefault(),e.target===this.element&&this.dropEmitter.emit({type:"over",data:null,ev:e})},e.prototype.onDrop=function(e){e.preventDefault(),e.target===this.element&&(this.backToNormal(this.element.children),this.dropEmitter.emit({type:"drop",data:this.dragDropService.dragTargets,ev:e}),this.cdRef.reattach())},e.prototype.onDragLeave=function(e){e.preventDefault(),e.target===this.element&&(this.backToNormal(this.element.children),this.dropEmitter.emit({type:"leave",data:null,ev:e}),this.cdRef.reattach())},e.prototype.onDragEnter=function(e){e.preventDefault(),this.forbiddenChildPointerEvents(this.element.children),this.element===e.target&&(this.cdRef.detach(),this.dropEmitter.emit({type:"enter",data:null,ev:e}))},e.prototype.forbiddenChildPointerEvents=function(e){for(var t=0;t<e.length;t++)e[t].style.pointerEvents="none"},e.prototype.backToNormal=function(e){for(var t=0;t<e.length;t++)e[t].style.pointerEvents="auto"},e.prototype.ngOnDestroy=function(){this.dragoverSub&&this.dragoverSub.unsubscribe(),this.dragenterSub&&this.dragenterSub.unsubscribe(),this.dragleaveSub&&this.dragleaveSub.unsubscribe()},e}()},KuJF:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("K9Ia"),r=function(){function e(e,t){this.selectChange=new n.a,this.lastIndex=null,this._selected=t,this._selected.length>1&&(this._multiStatus=!0),this.dataSource=e}return Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},enumerable:!0,configurable:!0}),e.prototype.clickTarget=function(e,t,i){if(i&&(this._multiStatus=!0),e.shiftKey)this.shiftSelect(t),this._multiStatus=!0;else if(e.ctrlKey)this.ctrSelect(t),this._multiStatus=!0;else{if(this._multiStatus)this.toggleSelect(t);else{var n=this._selected.filter(function(e){return e.id!==t.id});this.groupDeselect(n),this.toggleSelect(t)}var r=this.findIndex(t,this.dataSource);this.lastIndex=r>-1?r:null}},e.prototype.groupSelect=function(e){var t=this;e.forEach(function(e){t.select(e)}),this._multiStatus=!0},e.prototype.groupDeselect=function(e){var t=this;e.forEach(function(e){t.deselect(e)})},e.prototype.isSelected=function(e){return!!this._selected.find(function(t){return t.id===e.id})},e.prototype.getSelectedNumFrom=function(e){var t=this,i=0;return e.forEach(function(e){t.isSelected(e)&&(i+=1)}),i},Object.defineProperty(e.prototype,"isMultiStatus",{get:function(){return this._multiStatus},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._multiStatus=!1,this._selected=[]},e.prototype.toggleSelect=function(e){this.isSelected(e)?this.deselect(e):this.select(e)},e.prototype.select=function(e){if(!this.isSelected(e)){var t=this._selected.slice();t.push(e),this._selected=t}this.selectChange.next(this._selected)},e.prototype.deselect=function(e){var t=this.findIndex(e,this._selected);if(t>-1){var i=this._selected.slice();i.splice(t,1),this._selected=i}this.selectChange.next(this._selected)},e.prototype.shiftSelect=function(e){var t=this,i=this.findIndex(e,this.dataSource);if(-1!==i){var n=null!==this.lastIndex?this.lastIndex:i;this.dataSource.slice(Math.min(i,n),Math.max(i,n)+1).forEach(function(e){t.ctrSelect(e)})}},e.prototype.ctrSelect=function(e){this.select(e)},e.prototype.findIndex=function(e,t){return t.findIndex(function(t){return t.id===e.id})},e}()},St6j:function(e,t,i){"use strict";i.d(t,"a",function(){return c}),i.d(t,"b",function(){return d}),i("g0Zh"),i("w6Hz"),i("5fUb"),i("IyOr"),i("AfRD"),i("kJ5x"),i("JDDX"),i("2ARg");var n=i("AytR"),r=i("qV8f"),o=i("K9Ia"),l=i("LvDl"),s=i("ny24"),a=i("KuJF"),c=function(){function e(){}return e.showMediaFilter=function(e){return e.hover||e.menuExpanded||e.groupChoose||e.partChoose},e.showContentFilter=function(e,t,i){return e.hover||e.menuExpanded||t.some(function(e){return i.findIndex(function(t){return t.id===e.id})>-1})},e.mouseEnterFilter=function(e){e.hover=!0},e.mouseLeaveFilter=function(e){e.hover=!1},e.menuOpen=function(e){e.menuExpanded=!0},e.menuClose=function(e){e.hover=!1,e.menuExpanded=!1},e}(),d=function(){function e(e,t,i,n,r,c,d,h,u,f,p,g,m,b){var S=this;this.mediaService=e,this.dialogRef=t,this.el=i,this.nav=n,this.infoService=r,this.router=c,this.createMedia=d,this.program=h,this.flowService=u,this.crequest=f,this.tracker=p,this.ele=g,this.store=m,this.cdR=b,this.medias=[],this.params={_embed:"true",per_page:"12",page:"1",status:"any"},this.isPC=!0,this.mediaSelected=[],this.destroy$=new o.a,this.store.select(function(e){return e.mediaData.mediaSelected}).pipe(Object(s.a)(this.destroy$)).subscribe(function(e){S.mediaSelected=l.cloneDeep(e),0===e.length&&S.unSelect()}),this.store.select(function(e){return e.mediaData.media}).pipe(Object(s.a)(this.destroy$)).subscribe(function(e){e.length>0&&(S.selectionModel=new a.a(e,S.mediaSelected))})}return e.prototype.ngAfterViewChecked=function(){this.cdR.detectChanges()},e.prototype.dispatchSelectedChange=function(){this.store.dispatch(Object(r.c)({selected:this.mediaSelected})),this.store.dispatch(Object(r.b)({selected:[]}))},e.prototype.showPreview=function(e){this.mediaService.updateSelectMedia(e,this.medias)},e.prototype.create=function(e){this.createMedia.sendMedia([e]),this.router.navigate(["/create",{type:"file"}])},e.prototype.download=function(e){var t=document.createElement("a"),i=document.createEvent("HTMLEvents");i.initEvent("click",!1,!1),t.href=e.source_url,t.download=e.name,t.dispatchEvent(i),t.click()},e.prototype.onSelect=function(){return!1},e.prototype.ngOnInit=function(){this.url=n.a.apiEndpoint+"/wp-json/wp/v2/programs/",this.listenClickEvent(),this.isPC=this.IsPC()},e.prototype.IsPC=function(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],i=!0,n=0;n<t.length;n++)if(e.indexOf(t[n])>0){i=!1;break}return i},e.prototype.listenClickEvent=function(){var e=this;this.tracker.events$.subscribe(function(t){t&&t.uniqueKey&&"MEDIA"===t.uniqueKey&&e.unSelect()})},e.prototype.unSelect=function(){this.mediaService.selectMedia={name:"",src:""},this.selectionModel&&this.selectionModel.clear()},e.prototype.clickMedia=function(e,t,i){this.selectionModel.clickTarget(e,t,i),this.mediaSelected=this.selectionModel.selected,this.mediaService.selectMedia=t,this.store.dispatch(Object(r.l)({id:this.mediaSelected.length>0?t.id:null})),this.dispatchSelectedChange()},e.prototype.clickCheckbox=function(e,t){e.stopPropagation(),this.clickMedia(e,t,!0)},e.prototype.All=function(e){this.selectionModel.groupSelect(e.value),this.mediaSelected=this.unique(e.value),this.selectionModel.groupSelect(this.mediaSelected),this.dispatchSelectedChange()},e.prototype.unique=function(e){return l.uniqWith(e.concat(this.mediaSelected),l.isEqual)},e.prototype.None=function(e){this.selectionModel.groupDeselect(e.value),this.mediaSelected=this.mediaSelected.filter(function(t){return!e.value.find(function(e){return e.id===t.id})}),this.dispatchSelectedChange()},e.prototype.ifProgram=function(e,t){t.selectNum=0,this.None(t);var i=t.value.filter(function(e){return e.attachment_program_detail.length>0}),n=t.value.filter(function(e){return!(e.attachment_program_detail.length>0)});e?(this.selectionModel.groupDeselect(n),this.selectionModel.groupSelect(i)):(this.selectionModel.groupDeselect(i),this.selectionModel.groupSelect(n)),this.mediaSelected=this.selectionModel.selected,this.dispatchSelectedChange()},e.prototype.ifSelectGroupAll=function(e){return e.value.length===this.selectionModel.getSelectedNumFrom(e.value)},e.prototype.ifSelectGroupSome=function(e){var t=e.value.length,i=this.selectionModel.getSelectedNumFrom(e.value);return i>0&&i<t},e.prototype.toggleMediaFilter=function(e,t){e.showFilter=t},e.prototype.ifShowMediaFilter=function(e){return!!e.menuExpened||e.showFilter||this.selectionModel.getSelectedNumFrom(e.value)>0},e.prototype.filterMenuToggle=function(e,t){e.menuExpened=t},e.prototype.toggleMediaCheckbox=function(e,t){e.showCheckBox=!!this.selectionModel.isMultiStatus||t},e.prototype.ifMediaSelected=function(e){return this.selectionModel.isSelected(e)},e.prototype.ifShowCheckBox=function(e){return!!e.showCheckBox||this.selectionModel.isMultiStatus},e.prototype.filterItem=function(e){this.ifSelectGroupAll(e)?this.None(e):this.All(e)},e.prototype.trackById=function(e,t){return t.id+e},e.prototype.ngOnChanges=function(e){if(void 0!==e.medias){var t=e.medias.currentValue;this.previewMedias=t,this.medias=t}},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete(),this.store.dispatch(Object(r.c)({selected:[]}))},e}()},c7dS:function(e,t,i){"use strict";var n=i("CcnG"),r=i("Z5h4"),o=i("gIcY"),l=i("de3e"),s=i("lLAP"),a=i("wFw1"),c=i("6UMx"),d=i("0/Q6"),h=i("5ATD"),u=i("nHm3"),f=i("xj3x"),p=i("Ip0R"),g=i("A7o+"),m=i("15B3"),b=i("EoEU"),S=i("FYhI");i("j55m"),i.d(t,"a",function(){return v}),i.d(t,"b",function(){return O});var v=n.vb({encapsulation:0,styles:[[".drag-list-container[_ngcontent-%COMP%]{position:relative}.drag-list-container[_ngcontent-%COMP%]   .program-list[_ngcontent-%COMP%]{position:relative;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.drag-list-container[_ngcontent-%COMP%]   .program-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;height:41px}.drag-list-container[_ngcontent-%COMP%]   .program-list[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{position:absolute;top:10px;left:30px;color:#777777ab}.drag-list-container[_ngcontent-%COMP%]   .program-row[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:flex-start}"]],data:{}});function y(e){return n.Rb(0,[(e()(),n.xb(0,0,null,null,2,"mat-checkbox",[["class","mat-checkbox"]],[[8,"id",0],[1,"tabindex",0],[2,"mat-checkbox-indeterminate",null],[2,"mat-checkbox-checked",null],[2,"mat-checkbox-disabled",null],[2,"mat-checkbox-label-before",null],[2,"_mat-animation-noopable",null]],[[null,"click"],[null,"change"]],function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==i.stopPropagation()&&n),"change"===t&&(n=!1!==(i?r.toggleSection(e.parent.context.$implicit):null)&&n),n},r.b,r.a)),n.Mb(5120,null,o.p,function(e){return[e]},[l.b]),n.wb(2,8568832,null,0,l.b,[n.k,n.h,s.h,n.B,[8,null],[2,l.a],[2,a.a]],{checked:[0,"checked"],indeterminate:[1,"indeterminate"]},{change:"change"})],function(e,t){var i=t.component;e(t,2,0,i.isSectionAllSelected(t.parent.context.$implicit),i.isSectionSelected(t.parent.context.$implicit))},function(e,t){e(t,0,0,n.Hb(t,2).id,null,n.Hb(t,2).indeterminate,n.Hb(t,2).checked,n.Hb(t,2).disabled,"before"==n.Hb(t,2).labelPosition,"NoopAnimations"===n.Hb(t,2)._animationMode)})}function w(e){return n.Rb(0,[(e()(),n.xb(0,0,null,null,2,"mat-checkbox",[["class","mat-checkbox"]],[[8,"id",0],[1,"tabindex",0],[2,"mat-checkbox-indeterminate",null],[2,"mat-checkbox-checked",null],[2,"mat-checkbox-disabled",null],[2,"mat-checkbox-label-before",null],[2,"_mat-animation-noopable",null]],[[null,"click"],[null,"change"]],function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==i.stopPropagation()&&n),"change"===t&&(n=!1!==r.selectChange(e.parent.context.$implicit)&&n),n},r.b,r.a)),n.Mb(5120,null,o.p,function(e){return[e]},[l.b]),n.wb(2,8568832,null,0,l.b,[n.k,n.h,s.h,n.B,[8,null],[2,l.a],[2,a.a]],{checked:[0,"checked"]},{change:"change"})],function(e,t){e(t,2,0,t.component.selection.isSelected(t.parent.context.$implicit))},function(e,t){e(t,0,0,n.Hb(t,2).id,null,n.Hb(t,2).indeterminate,n.Hb(t,2).checked,n.Hb(t,2).disabled,"before"==n.Hb(t,2).labelPosition,"NoopAnimations"===n.Hb(t,2)._animationMode)})}function x(e){return n.Rb(0,[(e()(),n.xb(0,0,null,null,0,null,null,null,null,null,null,null))],null,null)}function E(e){return n.Rb(0,[(e()(),n.xb(0,0,null,null,10,"mat-list-item",[["appDrag",""],["appInout",""],["class","program-row mat-list-item"],["role","listitem"]],[[2,"mat-list-item-avatar",null],[2,"mat-list-item-with-avatar",null]],[[null,"mouseenter"],[null,"mouseleave"],[null,"click"],[null,"dragstart"],[null,"dragend"]],function(e,t,i){var r=!0,o=e.component;return"dragstart"===t&&(r=!1!==n.Hb(e,6).onDragStart(i)&&r),"dragend"===t&&(r=!1!==n.Hb(e,6).ondragend(i)&&r),"mouseenter"===t&&(r=0!=(e.context.$implicit.hover=!0)&&r),"mouseleave"===t&&(r=0!=(e.context.$implicit.hover=!1)&&r),"click"===t&&(r=!1!==o.selectChange(e.context.$implicit)&&r),r},c.f,c.b)),n.wb(1,1228800,null,3,d.c,[n.k,n.h,[2,d.g],[2,d.a]],null,null),n.Nb(603979776,2,{_lines:1}),n.Nb(603979776,3,{_avatar:0}),n.Nb(603979776,4,{_icon:0}),n.wb(5,16384,null,0,h.a,[n.k],null,null),n.wb(6,16384,null,0,u.a,[n.k,f.a],{currentTarget:[0,"currentTarget"],selected:[1,"selected"]},null),(e()(),n.mb(16777216,null,2,1,null,w)),n.wb(8,16384,null,0,p.n,[n.S,n.P],{ngIf:[0,"ngIf"]},null),(e()(),n.mb(16777216,null,2,1,null,x)),n.wb(10,540672,null,0,p.u,[n.S],{ngTemplateOutletContext:[0,"ngTemplateOutletContext"],ngTemplateOutlet:[1,"ngTemplateOutlet"]},null)],function(e,t){var i=t.component;e(t,6,0,t.context.$implicit,i.selection.selected),e(t,8,0,i.ifShowCheckbox(t.context.$implicit)),e(t,10,0,t.context.$implicit,i.template)},function(e,t){e(t,0,0,n.Hb(t,1)._avatar||n.Hb(t,1)._icon,n.Hb(t,1)._avatar||n.Hb(t,1)._icon)})}function D(e){return n.Rb(0,[(e()(),n.xb(0,0,null,null,10,null,null,null,null,null,null,null)),(e()(),n.xb(1,0,null,null,9,"mat-list",[["class","program-list mat-list mat-list-base"],["role","list"]],null,null,null,c.h,c.a)),n.wb(2,704512,null,0,d.a,[n.k],null,null),(e()(),n.xb(3,0,null,0,5,"div",[["class","section-header"]],null,[[null,"click"],[null,"mouseenter"],[null,"mouseleave"]],function(e,t,i){var n=!0,r=e.component;return"click"===t&&(n=!1!==r.toggleSection(e.context.$implicit)&&n),"mouseenter"===t&&(n=!1!==r.filterController.mouseEnterFilter(e.context.extra)&&n),"mouseleave"===t&&(n=!1!==r.filterController.mouseLeaveFilter(e.context.extra)&&n),n},null,null)),(e()(),n.mb(16777216,null,null,1,null,y)),n.wb(5,16384,null,0,p.n,[n.S,n.P],{ngIf:[0,"ngIf"]},null),(e()(),n.xb(6,0,null,null,2,"h5",[],null,null,null,null,null)),(e()(),n.Pb(7,null,[""," ",""])),n.Jb(131072,g.i,[g.j,n.h]),(e()(),n.mb(16777216,null,0,1,null,E)),n.wb(10,278528,null,0,p.m,[n.S,n.P,n.u],{ngForOf:[0,"ngForOf"]},null)],function(e,t){var i=t.component;e(t,5,0,i.filterController.showContentFilter(t.context.extra,t.context.$implicit,i.selection.selected)),e(t,10,0,t.context.$implicit)},function(e,t){e(t,7,0,t.context.date,n.Qb(t,7,1,n.Hb(t,8).transform(t.context.day)))})}function O(e){return n.Rb(0,[(e()(),n.xb(0,0,null,null,5,"div",[["class","drag-list-container"]],null,null,null,null,null)),(e()(),n.xb(1,0,null,null,4,"app-group-splitter",[],null,null,null,m.b,m.a)),n.wb(2,49152,null,1,b.a,[],{groupStrategy:[0,"groupStrategy"],groupData:[1,"groupData"]},null),n.Nb(335544320,1,{subGroup:0}),(e()(),n.mb(16777216,null,null,1,null,D)),n.wb(5,16384,[[1,4]],0,S.a,[n.P,n.S],null,null)],function(e,t){var i=t.component;e(t,2,0,i.groupBy,i.contents)},null)}},j55m:function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i("xj3x");var n=i("EoEU"),r=i("St6j"),o=function(){function e(e){this.dragService=e,this.contents=[],this.groupBy=n.b.MODIFIED,this.filterController=r.a}return e.prototype.isSectionAllSelected=function(e){return this.getSectionSelectLength(e)===e.length},e.prototype.isSectionSelected=function(e){var t=this.getSectionSelectLength(e);return t>0&&t<e.length},e.prototype.getSectionSelectLength=function(e){return this.selection.selected.filter(function(t){for(var i=0;i<e.length;i++)if(e[i].id===t.id)return!0}).length},e.prototype.toggleSection=function(e){this.isSectionAllSelected(e)?this.clearSection(e):this.selectSection(e),this.drawText()},e.prototype.selectChange=function(e){this.selection.toggle(e),this.drawText()},e.prototype.drawText=function(){this.dragService.draw(this.selection.selected.length)},e.prototype.clearSection=function(e){for(var t=0;t<e.length;t++)this.selection.deselect(e[t])},e.prototype.selectSection=function(e){for(var t=0;t<e.length;t++)this.selection.isSelected(e[t])||this.selection.select(e[t])},e.prototype.ifShowCheckbox=function(e){return!!this.selection.hasValue()||!!e.hover},e}()},nHm3:function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i("xj3x");var n=function(){function e(e,t){this.elRef=e,this.dragDropService=t,this.reorderIndex=null,this.element=e.nativeElement,this.element.getAttribute("draggable")||this.element.setAttribute("draggable","true")}return e.prototype.onDragStart=function(e){var t=this;this.dragDropService.clear();var i=e.dataTransfer;if(i.effectAllowed="copy",!(this.currentTarget&&this.selected instanceof Array))return!1;this.selected.length>1&&this.selected.filter(function(e){return e.id===t.currentTarget.id}).length>0?(i.setDragImage(this.dragDropService.dragImage,0,0),this.dragDropService.addAll(this.selected)):this.dragDropService.add(this.currentTarget),e.dataTransfer.setData("reorder",this.reorderIndex+""),null===this.reorderIndex&&this.dragDropService.showOuterHighLight.next({type:"start"})},e.prototype.ondragend=function(e){null===this.reorderIndex&&this.dragDropService.dragEndInit()},e}()},pH6K:function(e,t,i){"use strict";i.d(t,"a",function(){return n}),i("g0Zh");var n=function(){function e(e,t,i,n,r){var o=this;this.mediaService=e,this.el=t,this.renderer2=i,this.dialog=n,this.data=r,this.selected=[],this.folders=[],this.folderSelected=[],this.moveTo=!1,this.loading=!1,this.path=[void 0],this.lastPath=void 0,this.showRoot=!1,this.showRight=!1,r&&(this.folderSelected=r.folderSelected,this.selected=r.selected.map(function(e){return e.id}),r.folders?this.folders=r.folders:this.mediaService.getMediaFolders(1,100).subscribe(function(e){o.folders=e.folders,o.mediaService.allFolders=e.folders}))}return e.prototype.disableFolder=function(e){return this.folderSelected.map(function(e){return e.id}).indexOf(e)>-1},e.prototype.cancel=function(){this.dialog.close()},e.prototype.moveMedia=function(){var e=this;this.moveTo=!1,0===this.select&&0===this.folderSelected.length&&(this.select=[]),this.selected.forEach(function(t){e.mediaService.moveTo(t,e.select).subscribe(function(t){e.dialog.close(t)})});var t={title:"",description:""};this.folderSelected.forEach(function(i){t.title=i.name,t.description=i.description,e.mediaService.moveFolder(e.select,i.id,t).subscribe(function(t){e.dialog.close(!0)})})},e.prototype.backPath=function(){var e=this;this.loading=!0,void 0===this.lastPath?(this.showRoot=!0,this.lastPath=void 0,this.loading=!1,this.select=void 0):(this.showRoot=!1,this.mediaService.getMediaFolders(1,100,this.lastPath).subscribe(function(t){e.folders=t.folders,e.loading=!1,e.select=e.lastPath,e.path.pop(),e.lastPath=e.path[e.path.length-1]}))},e.prototype.enterFolder=function(e){var t=this;this.select=e.id,this.loading=!0,0===e.id?(this.showRoot=!1,this.loading=!1):(this.lastPath=e.parent,this.path.push(this.lastPath),this.mediaService.getMediaFolders(1,100,e.id).subscribe(function(e){t.folders=e.folders,t.loading=!1}))},e.prototype.selectFolder=function(e){this.select=e===this.select?void 0:e},e.prototype.ngOnInit=function(){},e}()},qSGc:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(e){return e.ADMINISTRATOR="administrator",e.EDITOR="editor",e.MANAGER="manager",e.AUDITOR="auditor",e.CONTRIBUTOR="contributor",e.SUBSCRIBER="subscriber",e.SUPERVISOR="supervisor",e.MONITOR="monitor",e.INVITEE="invitee",e.GUEST="guest",e.TERMINAL="terminal",e}({})},uBgS:function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"c",function(){return l}),i.d(t,"b",function(){return s}),i("l9NK"),i("4FSw");var n=i("y58h"),r=(i("NQG6"),i("+bt8"),i("KXJF"),i("yGQT")),o=(i("fz2B"),Object(r.x)(function(e){return e.mediaData},n.c)),l=Object(r.x)(function(e){return e.mediaData},n.e),s=(Object(r.x)(function(e){return e.mediaData},n.b),Object(r.x)(function(e){return e.mediaData},n.d));Object(r.x)(function(e){return e.mediaData},n.a),Object(r.x)(function(e){return e.mediaData},n.g)},w6Hz:function(e,t,i){"use strict";i.d(t,"a",function(){return g});var n=i("CcnG"),r=i("g0Zh"),o=i("pH6K"),l=(i("5fUb"),i("IyOr"),i("0gu+"),i("udsX")),s=i("MwwG"),a=i("xdDY"),c=i("uBgS"),d=i("qV8f"),h=i("Nr6V"),u=i("ELAf"),f=i("qSGc"),p=i("LvDl"),g=function(){function e(e,t,i,o,s,a,d,h,u){var g=this;this.infoService=e,this.mediaService=t,this.router=i,this.dialogRef=o,this.createMedia=s,this.authService=a,this.dialog=d,this.store=h,this.el=u,this.folders=[],this.isListView=!1,this.metaCaps={create:[l.a.CREATE_PROGRAM],delete:[l.a.READ_LOGS]},this.listView=new n.n,this.allowShareRoles=[f.a.ADMINISTRATOR,f.a.EDITOR,f.a.MANAGER],this.currentUser=this.authService.User,this.showDetailSub=this.store.select(function(e){return e.mediaData.ifShowDetail}).subscribe(function(e){if(void 0===g.ifShowDetail){var t=localStorage.getItem("mediaDetail");t&&(g.ifShowDetail=JSON.parse(t).ifShowDetail)}else g.ifShowDetail=e}),this.delSub=this.mediaService.judgeDelete.subscribe(function(e){g.canbeDelete=e}),this.fiSub=this.mediaService.finishDeleteMedia.subscribe(function(e){g.canbeDelete=!e,e&&g.clearSelect()}),this.mediaFolderChange=this.store.select(c.b).subscribe(function(e){if(g.folders=p.cloneDeep(e.folders),g.folderPath=g.folderPath?e.folderPath:r.a.getLocalFolderPath(),"number"!=typeof e.currentFolderId){var t=r.a.getLocalParams();g.parentNodeId="number"==typeof t.mfolder?t.mfolder:0}else g.parentNodeId=0}),this.mediaQueryParamsSub=this.store.select(function(e){return e.mediaData.mediaQueryParams}).subscribe(function(e){g.mediaQueryParams=g.mediaQueryParams?e:r.a.getLocalParams()}),this.mediaStatusSub=this.store.select(function(e){return e.mediaData.mediaStatus}).subscribe(function(e){g.mediaStatus=g.mediaStatus?e:r.a.getLocalMediaStatus()}),this.mediaSelectedChangeSub=this.store.select(function(e){return e.mediaData.mediaSelected}).subscribe(function(e){g.mediaSelected=p.cloneDeep(e)}),this.folderSelectedChangeSub=this.store.select(function(e){return e.mediaData.folderSelected}).subscribe(function(e){g.folderSelected=p.cloneDeep(e)})}return e.prototype.ngOnDestroy=function(){this.showDetailSub.unsubscribe(),this.fiSub.unsubscribe(),this.delSub.unsubscribe(),this.mediaFolderChange.unsubscribe(),this.mediaQueryParamsSub.unsubscribe(),this.mediaStatusSub.unsubscribe(),this.mediaSelectedChangeSub.unsubscribe(),this.folderSelectedChangeSub.unsubscribe(),this.el.nativeElement.onclick=null},e.prototype.clearSelect=function(){this.store.dispatch(Object(d.c)({selected:[]})),this.store.dispatch(Object(d.b)({selected:[]}))},e.prototype.showPreview=function(){this.mediaService.updateSelectMedia(this.mediaService.selectMedia)},Object.defineProperty(e.prototype,"ifShowNavBar",{get:function(){return"upload"!==this.mediaService.selectedTab},enumerable:!0,configurable:!0}),e.prototype.paramChange=function(e){this.mediaSearchParams=r.a.setSearchParam(e),this.store.dispatch(Object(d.k)({params:this.mediaSearchParams})),r.a.ifSearch(this.mediaSearchParams)?this.store.dispatch(Object(d.j)({params:this.mediaSearchParams})):this.store.dispatch(Object(d.d)({params:this.mediaQueryParams})),this.store.dispatch(Object(d.c)({selected:[]}))},e.prototype.refreshMedia=function(){this.mediaStatus===h.a.SEARCH?this.store.dispatch(Object(d.j)({params:this.mediaSearchParams})):this.mediaStatus===h.a.QUERY&&this.store.dispatch(Object(d.d)({params:this.mediaQueryParams})),this.store.dispatch(Object(d.c)({selected:[]}))},e.prototype.toggleDetail=function(){this.ifShowDetail=!this.ifShowDetail,this.store.dispatch(Object(d.l)({open:this.ifShowDetail,id:null}))},e.prototype.changeView=function(){this.isListView=!this.isListView,this.listView.emit([this.isListView]),localStorage.setItem("ListView",JSON.stringify(this.isListView))},e.prototype.moveToFolder=function(e,t){var i=this;this.folders=this.mediaService.allFolders;var n=this.dialogRef,r=this.dialogConfig;e&&(r.data.selected=[e],r.data.folderSelected=[]),t&&(r.data.selected=[],r.data.folderSelected=[t]),this.mediaSelected.length>0&&(r.data.selected=this.mediaSelected),this.folderSelected&&this.folderSelected.length>0&&(r.data.folderSelected=this.folderSelected),n.open(o.a,r).afterClosed().subscribe(function(e){e&&(i.store.dispatch(Object(d.d)({params:{}})),i.store.dispatch(Object(d.c)({selected:[]})))})},e.prototype.getSelectedMediaExceptZip=function(){for(var e=this.mediaSelected,t=0;t<e.length;t++)if(this.mediaService.isUpgradePackage(e[t].file_type))return[];return e},e.prototype.canBeCreateProgram=function(){return this.getSelectedMediaExceptZip().length>0},e.prototype.createFile=function(){if(!this.currentUser.hasCapability(l.a.CREATE_PROGRAM))return!1;this.createMedia.sendMedia(this.getSelectedMediaExceptZip()),this.router.navigate(["/create",{type:"file"}])},Object.defineProperty(e.prototype,"dialogConfig",{get:function(){return{data:{mediaSelected:this.mediaSelected,folders:this.folders,folderSelected:this.folderSelected},width:"300px"}},enumerable:!0,configurable:!0}),e.prototype.deleteFiles=function(e,t){var i=this;"media"===t?this.mediaService.deleteMedia(e[0]).subscribe(function(){i.refreshMedia()}):"medias"===t?this.mediaService.bulkDeleteMedia(e).subscribe(function(){i.refreshMedia()}):"folder"===t&&this.mediaService.bulkDeleteFolders(e).subscribe(function(e){i.store.dispatch(Object(d.f)({folderId:i.parentNodeId,param:{type:"refresh",folderPath:i.folderPath}})),i.store.dispatch(Object(d.d)({params:{}})),i.store.dispatch(Object(d.c)({selected:[]}))})},e.prototype.bulkDeleteMedias=function(){var e,t,i,n=this,r=[];1===this.mediaSelected.length&&(r=[this.mediaSelected[0].id],e=this.mediaSelected[0],t=!0,i="media"),this.mediaSelected.length>1&&(r=this.mediaSelected.map(function(e){return e.id}),e={length:this.mediaSelected.length},t=!1,i="medias"),this.folderSelected.length>0&&(r=this.folderSelected.map(function(e){return e.id}),1===this.folderSelected.length?(e=this.folderSelected[0],t=!0):(e={length:this.folderSelected.length},t=!1),i="folder"),this.dialog.open(s.a,{width:"450px",data:{file_info:e,isSingle:t,from:i}}).afterClosed().subscribe(function(e){e&&e.delete&&n.deleteFiles(r,e.type)})},e.prototype.ngOnInit=function(){var e=this;this.isListView=JSON.parse(localStorage.getItem("ListView")),this.el.nativeElement.onclick=function(){e.store.dispatch(Object(d.c)({selected:[]}))}},e.prototype.ngOnChanges=function(e){void 0!==e.singleSelectG&&0!==e.singleSelectG.currentValue.length&&(this.canbeDelete=0===e.singleSelectG.currentValue[0].attachment_program.length),void 0!==e.singleSelect&&0!==e.singleSelect.currentValue.length&&(this.canbeDelete=0===e.singleSelect.currentValue[0].attachment_program.length)},e.prototype.canbeMoveToFolder=function(){return"share"!==this.mediaService.selectedTab&&(this.mediaSelected.length>0||this.folderSelected.length>0)},e.prototype.canbeBulkDeleteMedias=function(){return(this.folderSelected.length>0||r.a.judge(this.mediaSelected))&&"own"===this.mediaService.selectedTab},e.prototype.canShowPreview=function(){return 1===this.mediaSelected.length},Object.defineProperty(e.prototype,"canShowBindTags",{get:function(){return this.mediaSelected.length>0&&"own"===this.mediaService.selectedTab},enumerable:!0,configurable:!0}),e.prototype.bindTags=function(){this.dialog.open(a.a,{data:{media:this.mediaSelected},disableClose:!0,width:"400px"})},Object.defineProperty(e.prototype,"ifShowShareTo",{get:function(){return this.mediaSelected.length>0&&0===this.mediaSelected.filter(function(e){return"zip"===e.file_type}).length&&"own"===this.mediaService.selectedTab},enumerable:!0,configurable:!0}),e.prototype.shareTo=function(){this.dialog.open(u.a,{width:"800px",height:"500px",data:{media:this.mediaSelected.map(function(e){return e.id})}})},e}()},xj3x:function(e,t,i){"use strict";i.d(t,"b",function(){return a}),i.d(t,"c",function(){return c}),i.d(t,"a",function(){return d});var n=i("GmxD"),r=i("26FU"),o=i("CcnG"),l=i("BgWK"),s=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)l.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return l},a=function(e){return e[e.LIST=0]="LIST",e[e.GRID=1]="GRID",e}({}),c=function(e){return e[e.NEW=0]="NEW",e[e.ADD=1]="ADD",e[e.OVERLAP=2]="OVERLAP",e[e.PAGE=3]="PAGE",e}({}),d=function(){function e(e){this._bottomSheet=e,this.dragTargets=[],this.showOuterHighLight=new r.a(null),this.tipRectColor={new:"red",add:"blue",multi:"yellow",page:"green"},this.insertIndex=0}return e.prototype.dragEndInit=function(){this.showOuterHighLight.next(null),this.clear()},e.prototype.clear=function(){this.dragTargets=[]},e.prototype.add=function(e){this.dragTargets.push(e)},e.prototype.addAll=function(e){this.dragTargets=this.dragTargets.concat(e)},e.prototype.createCanvas=function(){var e=document.createElement("canvas");e.width=50,e.height=50,this.canvas=e},e.prototype.draw=function(e){this.createCanvas();var t=this.canvas.getContext("2d");t.beginPath(),t.fillStyle="red",t.arc(this.canvas.width/2,this.canvas.height/2,this.canvas.width/2,0,2*Math.PI),t.fill(),t.font=this.canvas.width+"px serif",t.fillStyle="#fff",t.textBaseline="hanging",t.textAlign="center",t.fillText(e,this.canvas.width/2,2),this.dragImage=new Image,this.dragImage.src=this.canvas.toDataURL("image/png",1)},e.prototype.dropToCreateFileWindow=function(e){e.windows.add("fileWindow"),this.addMediaToFileWindow(e)},e.prototype.dropToAddMediaToFileWindow=function(e,t){if(0!==t.windows.get().length){var i=e.dataTransfer.getData("reorder");if("null"!==i){var n=t.windows.getSelected().children,r=n[i],o=this.getReorderIndex(n.length);return n[i]=n[o],void(n[o]=r)}var l=e.target;this.addMediaToFileWindow(t,null,0===l.offsetWidth?l.children[0]:l)}},e.prototype.getReorderIndex=function(e){return this.insertIndex<=0?0:this.insertIndex>e-1?e-1:this.insertIndex-1},e.prototype.getListViewDropIndex=function(e){var t=e.offsetY,i=Math.floor(t/108),n=i;return t>108*i+54&&(n+=1),this.listHighLight(e.target,n,108),n},e.prototype.getGridViewDropIndex=function(e){var t=0===e.target.offsetWidth?e.target.children[0]:e.target,i=t.offsetWidth,n=t.children.length;if(0===n)return 0;var r=e.offsetX,o=Math.ceil(e.offsetY/104),l=Math.floor(i/104),s=Math.floor(r/104);s>=l&&(o+=1,s=0,r=0);var a=(o-1)*l+s;return a>n-2&&(s=n-1-(o-1)*l),r>104*s+52&&a<=n-2&&(a+=1,s+=1),this.gridHighLight(t,o,s,104),a},e.prototype.gridHighLight=function(e,t,i,n){this.highLightElement&&this.highLightElement.parentNode===e||(this.highLightElement=this.createElement(5,n),e.appendChild(this.highLightElement)),this.highLightElement.style.left=i*n+"px",this.highLightElement.style.top=(t-1)*n+"px"},e.prototype.listHighLight=function(e,t,i){this.highLightElement&&this.highLightElement.parentNode===e||(this.highLightElement=this.createElement(e.offsetWidth,5),this.highLightElement.style.left="0px",e.appendChild(this.highLightElement)),this.highLightElement.style.top=t*i+"px"},e.prototype.createElement=function(e,t){var i=document.createElement("div");return i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.width=e+"px",i.style.height=t+"px",i.style.backgroundColor="#1A73E8",i},e.prototype.removeHighlight=function(e){this.highLightElement&&this.highLightElement.parentNode===e&&e.removeChild(this.highLightElement)},e.prototype.selectFileWindowWhenDragOver=function(e,t){var i=t.windows.get(),n=this.getFileWindow(i);if(0!==n.length){var r=this.getTargetWindow(n,e,t);if(r&&0!==r.length){var o=r[r.length-1];if(!this.targetWindow||this.targetWindow.window.id!==o.window.id){this.targetWindow=o;var l=t.getContentInfo().info.Information.Scale;this.showOuterHighLight.next({rect:o.window.Rect,scale:l})}}}},e.prototype.getTargetWindow=function(e,t,i){var n=i.getContentInfo();if(n){var r=n.info.Information.Scale,o=t.offsetX/r,l=t.offsetY/r;return e.filter(function(e){return o>e.window.Rect.X&&o<e.window.Rect.X+e.window.Rect.Width&&l>e.window.Rect.Y&&l<e.window.Rect.Y+e.window.Rect.Height})}},e.prototype.dropToPreviewer=function(e,t){var i=t.windows.get(),n=this.getFileWindow(i);if(0===n.length)this.dropToCreateFileWindow(t);else{var r=this.getTargetWindow(n,e,t);if(!r)return;0===r.length?this.dropToCreateFileWindow(t):this.addMediaToFileWindow(t,1===r.length?r[0]:r[r.length-1])}},e.prototype.dropToAddPageAndCreateFileWindow=function(e){e.pages.add().initWindow(),this.dropToCreateFileWindow(e)},e.prototype.getFileWindow=function(e){return e&&e instanceof Array?e.map(function(e,t){if("fileWindow"===e.type)return{window:e,index:t}}).filter(function(e){return!!e}):[]},e.prototype.addMediaToFileWindow=function(e,t,i){var n,r,o=this;t?(r=t.window,e.windows.select(t.index)):r=e.windows.getSelected();var l=this.dragTargets.map(function(e){return o.formatMedia(e)}).filter(function(e){return!!e});r.children&&r.children instanceof Array?i&&this.insertIndex<i.children.length?(n=r.children).splice.apply(n,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}([this.insertIndex,0],l)):r.children=r.children.concat(l):r.children=l,e.emit("pageInfoChanged")},e.prototype.formatMedia=function(e){return Object.assign({},e,{fileID:e.id,id:Math.random(),Duration:e.duration||8e3,ReserveAS:0,playTime:e.duration/1e3||8,PlayTimes:"1",inEffect:{Name:"No Effect",Type:0,Time:1500,webTime:1.5},attachment_filesize:this.formatSize(e.attachment_filesize)})},e.prototype.formatSize=function(e){return e>=1048576?(e/1048576).toFixed(2)+" MB":e<1048576?(e/1024).toFixed(0)+" KB":void 0},e.prototype.openTipDialog=function(e){return this.closeTipDialog(),this._bottomSheetRef=this._bottomSheet.open(n.a,{data:e,hasBackdrop:!1}),this._bottomSheetRef},e.prototype.closeTipDialog=function(){this._bottomSheetRef&&this._bottomSheetRef.dismiss()},e.prototype.handleEvent=function(e,t,i,n){if(0!==this.dragTargets.length&&("drop"===t.type||"leave"===t.type?i===c.ADD&&this.removeHighlight(0===t.ev.target.offsetWidth?t.ev.target.children[0]:t.ev.target):"over"===t.type&&i===c.ADD?this.insertIndex=t.viewType===a.GRID?this.getGridViewDropIndex(t.ev):this.getListViewDropIndex(t.ev):"over"===t.type&&i===c.OVERLAP&&this.selectFileWindowWhenDragOver(t.ev,n),"drop"===t.type))switch(this.targetWindow=null,i){case c.NEW:this.dropToCreateFileWindow(n);break;case c.ADD:this.dropToAddMediaToFileWindow(t.ev,n);break;case c.OVERLAP:this.dropToPreviewer(t.ev,n);break;case c.PAGE:this.dropToAddPageAndCreateFileWindow(n);break;default:return}},e.ngInjectableDef=o.Tb({factory:function(){return new e(o.Xb(l.b))},token:e,providedIn:"root"}),e}()}}]);